---
description: 分析和整理知识库，提供优化建议，维护知识库的整洁和有序
---

请帮我分析和整理知识库：

**范围**: $ARGUMENTS (可选: all, ai-ml, programming, 或特定目录)

## 执行步骤

### 1. 扫描分析

#### 1.1 全库扫描
扫描指定目录下的所有 Markdown 文件：
- 统计知识条目数量
- 分析元数据完整性
- 检查格式一致性
- 识别问题文件

#### 1.2 详细分析
```markdown
## 📊 知识库分析报告

### 整体统计
- **总知识条目**: 158个
- **AI/ML**: 45个 (28.5%)
- **Programming**: 60个 (38.0%)
- **Tech Knowledge**: 53个 (33.5%)

### 元数据统计
- **元数据完整**: 142个 (89.9%)
- **元数据不完整**: 16个 (10.1%)
- **平均字段数**: 7.2/9个

### 质量指标
- **格式一致性**: 85%
- **标签准确性**: 78%
- **文件命名规范**: 92%
- **内容完整度**: 88%

### 学习统计
- **本月新增**: 12个
- **本月复习**: 45次
- **平均掌握度**: 3.4/5
- **待复习**: 23个 (14.6%)
```

### 2. 识别问题

#### 2.1 元数据问题
```markdown
## ⚠️ 发现的问题

### 1. 元数据缺失 (16个)
**高优先级** (需要立即处理):
1. `ai-ml/agent/prompt-eng.md`
   - 缺少: tags, mastery, updated
   - 影响: 无法正确索引和复习

2. `programming/react/state.md`
   - 缺少: created, updated
   - 影响: 无法追踪学习进度

**中优先级** (建议处理):
3. `tech-knowledge/git/branches.md`
   - 缺少: mastery, review_dates
   - 影响: 无法跟踪复习进度

4. `ai-ml/llm/fine-tuning.md`
   - 缺少: difficulty, related
   - 影响: 缺少重要信息

### 2. 格式不一致 (8个)
1. `tech-knowledge/git/branches.md`
   - 问题: 标题格式 "## Git 分支管理"
   - 建议: 改为 "# Git 分支管理"
   - 影响: 目录结构不统一

2. `programming/python/decorators.md`
   - 问题: 代码块语言标识不统一
   - 建议: 统一使用 `python`
   - 影响: 代码高亮失效

### 3. 文件位置错误 (3个)
1. `ai-ml/mcp.md`
   - 问题: 应该在 ai-ml/mcp/mcp-basics.md
   - 原因: 违反目录结构规范
   - 建议: 移动到正确位置

2. `testing.md`
   - 问题: 应该在 tech-knowledge/testing/
   - 原因: 未正确分类
   - 建议: 移动并重命名

### 4. 潜在重复内容 (5个)
1. `llm-basics.md` vs `llm-introduction.md`
   - 相似度: 92%
   - 建议: 合并为一个文件，保留更完整的版本
   - 影响: 知识冗余

2. `react-hooks-intro.md` vs `react-hooks.md`
   - 相似度: 85%
   - 建议: intro 内容合并到主文件
   - 影响: 内容分散

### 5. 孤立文件 (2个)
1. `tools/old-script.sh`
   - 无反向链接，无元数据
   - 建议: 删除或移动到 archive/
   - 影响: 知识库混乱

2. `drafts/idea.md`
   - 草稿，未完成
   - 建议: 完成后整理或删除
   - 影响: 知识库质量

### 6. 失效链接 (1个)
1. `programming/python/decorators.md`
   - 链接: [Advanced Guide](broken-link)
   - 建议: 更新或删除链接
   - 影响: 资源不可用
```

### 3. 生成整理计划

```markdown
## 📋 整理计划

### 阶段1: 自动修复 (安全操作)
预计时间: 5分钟

- [x] 备份知识库到 .backups/organizer/2025-12-24/
- [ ] 修复16个元数据缺失
- [ ] 统一8个格式问题
- [ ] 更新1个失效链接

### 阶段2: 需确认操作
预计时间: 10分钟

#### 处理文件位置错误 (3个)
1. **ai-ml/mcp.md** → **ai-ml/mcp/mcp-basics.md**
   - 确认移动? (y/n)

2. **testing.md** → **tech-knowledge/testing/testing-basics.md**
   - 确认移动并重命名? (y/n)

3. **[其他]**
   - 确认操作? (y/n)

#### 处理重复内容 (5个)
1. **llm-basics.md** + **llm-introduction.md**
   - 相似度: 92%
   - 选项:
     1. 保留 llm-basics.md (更完整)
     2. 保留 llm-introduction.md (更清晰)
     3. 手动合并
   - 选择 (1/2/3):

2. **react-hooks-intro.md** + **react-hooks.md**
   - 相似度: 85%
   - 选项:
     1. 合并 intro 到主文件
     2. 保持独立
   - 选择 (1/2):

#### 处理孤立文件 (2个)
1. **tools/old-script.sh**
   - 选项:
     1. 删除
     2. 移动到 archive/
     3. 添加到索引
   - 选择 (1/2/3):

2. **drafts/idea.md**
   - 选项:
     1. 完成后整理
     2. 删除
     3. 移到 ideas/
   - 选择 (1/2/3):

### 阶段3: 验证和更新
预计时间: 5分钟

- [ ] 更新目录索引
- [ ] 验证所有链接有效性
- [ ] 生成整理报告
- [ ] 更新统计数据

### 总预计时间
- 最小操作: 5分钟
- 完整操作: 20分钟
```

### 4. 执行整理

#### 4.1 自动修复
```markdown
## 🔧 正在执行自动修复...

### 备份
✅ 创建备份: .backups/organizer/2025-12-24/

### 修复元数据 (16/16)
✅ ai-ml/agent/prompt-eng.md
   - 添加: tags, mastery, updated
✅ programming/react/state.md
   - 添加: created, updated
✅ ... (其他14个)

### 统一格式 (8/8)
✅ tech-knowledge/git/branches.md
   - 标题: ## → #
✅ programming/python/decorators.md
   - 代码块语言标识统一
✅ ... (其他6个)

### 更新链接 (1/1)
✅ programming/python/decorators.md
   - 更新失效链接

---
### ✅ 自动修复完成
- 修复文件: 25个
- 元数据完整度: 89.9% → 100%
- 格式一致性: 85% → 100%
- 链接有效性: 99.9%
```

#### 4.2 交互式确认
```markdown
## 🔍 需要确认的操作

### 操作1: 移动文件
**ai-ml/mcp.md** → **ai-ml/mcp/mcp-basics.md**

原因: 符合目录结构规范
影响: 更新相关链接
是否继续? (y/n/s=skip):

### 操作2: 合并重复内容
**llm-basics.md** (保留) + **llm-introduction.md** (删除)

原因: 内容重复92%
保留: llm-basics.md (更完整)
删除: llm-introduction.md
是否继续? (y/n/s=skip):
```

### 5. 生成报告

```markdown
## ✅ 整理完成报告

### 📊 统计信息

#### 修复的问题
- **元数据缺失**: 16个 → 0个 ✅
- **格式不一致**: 8个 → 0个 ✅
- **文件位置**: 3个 → 0个 ✅
- **重复内容**: 5个 → 0个 ✅
- **孤立文件**: 2个 → 0个 ✅
- **失效链接**: 1个 → 0个 ✅

#### 质量提升
- **元数据完整度**: 89.9% → 100% ⬆️
- **格式一致性**: 85% → 100% ⬆️
- **命名规范性**: 92% → 100% ⬆️
- **链接有效性**: 99% → 100% ⬆️

#### 文件变更
- **修改**: 28个文件
- **移动**: 3个文件
- **删除**: 6个文件
- **合并**: 5个文件
- **创建**: 1个索引文件

### 📁 生成的文件
1. **reports/organization-2025-12-24.md** - 详细整理报告
2. **.backups/organizer/2025-12-24/** - 备份文件
3. **目录索引.md** - 更新的索引

### 💡 后续建议

#### 每周任务
- 运行轻度整理 (自动模式)
- 检查新增文件的元数据
- 更新目录索引

#### 每月任务
- 全面整理 (完整模式)
- 清理过期内容
- 优化目录结构
- 生成月度报告

#### 持续改进
- 建立内容标准检查清单
- 配置 Git pre-commit hook
- 定期审查孤立文件
- 优化知识库结构

### 🎯 维护建议

1. **定期整理**: 每周运行一次自动模式
2. **及时处理**: 新增内容时立即规范
3. **版本控制**: 使用 Git 追踪变更
4. **备份策略**: 重要操作前自动备份

### 📈 改进效果

#### 整理前
- 元数据完整度: 89.9%
- 格式一致性: 85%
- 冗余内容: 5个
- 孤立文件: 2个
- 失效链接: 1个

#### 整理后
- 元数据完整度: 100% ⬆️ +11%
- 格式一致性: 100% ⬆️ +15%
- 冗余内容: 0个 ⬇️ -5
- 孤立文件: 0个 ⬇️ -2
- 失效链接: 0个 ⬇️ -1

### 🚀 下一步操作
选择:
1. 查看详细报告
2. 更新目录索引
3. 生成学习计划
4. 完成整理

选择 (1/2/3/4):
```

## 高级功能

### 自动模式
```bash
/organize --auto  # 仅执行安全操作
```

### 干运行模式
```bash
/organize --dry-run  # 仅分析，不执行
```

### 特定目录
```bash
/organize ai-ml  # 仅整理特定目录
```

### 生成报告
```bash
/organize --report  # 生成详细报告
```

## 注意事项

1. **备份优先**: 重要操作前自动备份
2. **交互确认**: 危险操作需要用户确认
3. **可逆操作**: 记录所有操作，支持撤销
4. **增量更新**: 避免大规模重命名

## 相关命令

- `/extract` - 提取知识条目
- `/connect` - 建立知识关联
- `/sync-status` - 同步学习状态
